var device = [ {
	manuFac : "東京測器",
	model : "ロッド",
	shape : "CDP-25",
	number : "5",
	manufaNo : "BBC 09229",
	managerNo : "CDP-25-01"
}, {
	manuFac : "東京測器",
	model : "ロッド",
	shape : "CDP-25",
	number : "5",
	manufaNo : "BBC 09231",
	managerNo : "CDP-25-03"
} ];
var dataHistory = [ {
	"id" : 1,
	"name" : "UC陸標柱曲げ試験",
	"startDate" : "2018/05/06",
	"endDate" : "2018/06/21",
	"device" : device
}, {
	"id" : 2,
	"name" : "UC陸標柱曲げ試験",
	"startDate" : "2018/06/06",
	"endDate" : "2018/07/22",
	"device" : device
}, {
	"id" : 3,
	"name" : "UC陸標柱曲げ試験",
	"startDate" : "2018/07/22",
	"endDate" : "2018/08/23",
	"device" : device
}, {
	"id" : 4,
	"name" : "UC陸標柱曲げ試験",
	"startDate" : "2018/08/24",
	"endDate" : "2018/09/25",
	"device" : device
}, {
	"id" : 5,
	"name" : "UC陸標柱曲げ試験",
	"startDate" : "2018/09/25",
	"endDate" : "2018/10/20",
	"device" : device
} ];

var dataApp = [ {
	"id" : 1,
	"testNo" : 'XXXX01',
	"process" : 1,
	"testName" : "屋内試験1001",
	"creator" : 1,
	"department" : "ポール部門",
	"createDate" : "	2018/09/10",
	"updateDate" : "2018/09/25",
	"intallName" : '住友　材子',
	"storgeName" : 'ポール部門',
	"startTime" : '2018/06/11',
	"endTime" : '2018/06/20',
	"products" : [ {
		name : 'Lower tube φ117～φ177.8-2.7m t=3.1mm',
		count : 10,
		intallDate : '2018/06/10',
		storgeDate : '2018/06/20',
	}, {
		name : '上管φ125～φ132-3.9m　t=3.1mm',
		count : 10,
		intallDate : '2018/06/10',
		storgeDate : '2018/06/20'
	} ]
}, {
	"id" : 1,
	"testNo" : 'XXXX02',
	"process" : 1,
	"testName" : "屋内試験1002",
	"creator" : 1,
	"department" : "ポール部門",
	"createDate" : "	2018/09/10",
	"updateDate" : "2018/09/25",
	"intallName" : '住友　材子',
	"storgeName" : 'ポール部門',
	"startTime" : '2018/06/11',
	"endTime" : '2018/06/20',
	"products" : [ {
		name : 'Lower tube φ117～φ177.8-2.7m t=3.1mm',
		count : 10,
		intallDate : '2018/06/10',
		storgeDate : '2018/06/20',
	}, {
		name : '上管φ125～φ132-3.9m　t=3.1mm',
		count : 10,
		intallDate : '2018/06/10',
		storgeDate : '2018/06/20'
	} ]
}, {
	"id" : 1,
	"testNo" : 'XXXX03',
	"process" : 2,
	"testName" : "屋内試験1003",
	"creator" : 1,
	"department" : "ポール部門",
	"intallName" : '住友　材子',
	"storgeName" : 'ポール部門',
	"createDate" : "	2018/09/10",
	"updateDate" : "2018/09/25",
	"startTime" : '2018/06/11',
	"endTime" : '2018/06/20',
	"products" : [ {
		name : 'Lower tube φ117～φ177.8-2.7m t=3.1mm',
		count : 10,
		intallDate : '2018/06/10',
		storgeDate : '2018/06/20',
	}, {
		name : '上管φ125～φ132-3.9m　t=3.1mm',
		count : 10,
		intallDate : '2018/06/10',
		storgeDate : '2018/06/20'
	} ]
}, {
	"id" : 1,
	"testNo" : 'XXXX04',
	"process" : 2,
	"testName" : "屋内試験1004",
	"creator" : 2,
	"department" : "ポール部門",
	"createDate" : "	2018/09/10",
	"updateDate" : "2018/09/25",
	"startTime" : '2018/06/11',
	"intallName" : '住友　材子',
	"storgeName" : 'ポール部門',
	"endTime" : '2018/06/20',
	"products" : [ {
		name : 'Lower tube φ117～φ177.8-2.7m t=3.1mm',
		count : 10,
		intallDate : '2018/06/10',
		storgeDate : '2018/06/20',
	}, {
		name : '上管φ125～φ132-3.9m　t=3.1mm',
		count : 10,
		intallDate : '2018/06/10',
		storgeDate : '2018/06/20'
	} ]
}, {
	"id" : 5,
	"testNo" : 'XXXX05',
	"process" : 2,
	"testName" : "屋内試験1005",
	"creator" : 2,
	"department" : "ポール部門",
	"intallName" : '住友　材子',
	"storgeName" : 'ポール部門',
	"createDate" : "	2018/09/10",
	"updateDate" : "2018/09/25",
	"startTime" : '2018/06/11',
	"endTime" : '2018/06/20',
	"products" : [ {
		name : 'Lower tube φ117～φ177.8-2.7m t=3.1mm',
		count : 10,
		intallDate : '2018/06/10',
		storgeDate : '2018/06/20',
	}, {
		name : '上管φ125～φ132-3.9m　t=3.1mm',
		count : 10,
		intallDate : '2018/06/10',
		storgeDate : '2018/06/20'
	} ]
}, {
	"id" : 6,
	"testNo" : 'XXXX06',
	"process" : 3,
	"testName" : "屋内試験1006",
	"creator" : 3,
	"department" : "ポール部門",
	"intallName" : '住友　材子',
	"storgeName" : 'ポール部門',
	"createDate" : "	2018/09/10",
	"updateDate" : "2018/09/25",
	"startTime" : '2018/06/11',
	"endTime" : '2018/06/20',
	"products" : [ {
		name : 'Lower tube φ117～φ177.8-2.7m t=3.1mm',
		count : 10,
		intallDate : '2018/06/10',
		storgeDate : '2018/06/20',
	}, {
		name : '上管φ125～φ132-3.9m　t=3.1mm',
		count : 10,
		intallDate : '2018/06/10',
		storgeDate : '2018/06/20'
	} ]
}, {
	"id" : 7,
	"testNo" : 'XXXX07',
	"process" : 3,
	"testName" : "屋内試験1007",
	"creator" : 4,
	"department" : "ポール部門",
	"intallName" : '住友　材子',
	"storgeName" : 'ポール部門',
	"createDate" : "	2018/09/10",
	"updateDate" : "2018/09/25",
	"startTime" : '2018/06/11',
	"endTime" : '2018/06/20',
	"products" : [ {
		name : 'Lower tube φ117～φ177.8-2.7m t=3.1mm',
		count : 10,
		intallDate : '2018/06/10',
		storgeDate : '2018/06/20',
	}, {
		name : '上管φ125～φ132-3.9m　t=3.1mm',
		count : 10,
		intallDate : '2018/06/10',
		storgeDate : '2018/06/20'
	} ]
}, {
	"id" : 8,
	"testNo" : 'XXXX08',
	"process" : 3,
	"testName" : "屋内試験1008",
	"intallName" : '住友　材子',
	"storgeName" : 'ポール部門',
	"creator" : 5,
	"department" : "ポール部門",
	"createDate" : "	2018/09/10",
	"updateDate" : "2018/09/25",
	"startTime" : '2018/06/11',
	"endTime" : '2018/06/20',
	"products" : [ {
		name : 'Lower tube φ117～φ177.8-2.7m t=3.1mm',
		count : 10,
		intallDate : '2018/06/10',
		storgeDate : '2018/06/20',
	}, {
		name : '上管φ125～φ132-3.9m　t=3.1mm',
		count : 10,
		intallDate : '2018/06/10',
		storgeDate : '2018/06/20'
	} ]
}, {
	"id" : 9,
	"testNo" : 'XXXX09',
	"process" : 4,
	"testName" : "屋内試験1009",
	"intallName" : '住友　材子',
	"storgeName" : 'ポール部門',
	"creator" : 5,
	"department" : "ポール部門",
	"createDate" : "	2018/09/10",
	"updateDate" : "2018/09/25",
	"startTime" : '2018/06/11',
	"endTime" : '2018/06/20',
	"products" : [ {
		name : 'Lower tube φ117～φ177.8-2.7m t=3.1mm',
		count : 10,
		intallDate : '2018/06/10',
		storgeDate : '2018/06/20',
	}, {
		name : '上管φ125～φ132-3.9m　t=3.1mm',
		count : 10,
		intallDate : '2018/06/10',
		storgeDate : '2018/06/20'
	} ]
}, {
	"id" : 10,
	"testNo" : 'XXXX010',
	"process" : 4,
	"testName" : "屋内試験1010",
	"intallName" : '住友　材子',
	"storgeName" : 'ポール部門',
	"creator" : 6,
	"department" : "ポール部門",
	"createDate" : "	2018/09/10",
	"updateDate" : "2018/09/25",
	"startTime" : '2018/06/11',
	"endTime" : '2018/06/20',
	"products" : [ {
		name : 'Lower tube φ117～φ177.8-2.7m t=3.1mm',
		count : 10,
		intallDate : '2018/06/10',
		storgeDate : '2018/06/20',
	}, {
		name : '上管φ125～φ132-3.9m　t=3.1mm',
		count : 10,
		intallDate : '2018/06/10',
		storgeDate : '2018/06/20'
	} ]
}, {
	"id" : 11,
	"testNo" : 'XXXX011',
	"process" : 4,
	"testName" : "屋内試験10011",
	"intallName" : '住友　材子',
	"storgeName" : 'ポール部門',
	"creator" : 6,
	"department" : "ポール部門",
	"createDate" : "	2018/09/10",
	"updateDate" : "2018/09/25",
	"startTime" : '2018/06/11',
	"endTime" : '2018/06/20',
	"products" : [ {
		name : 'Lower tube φ117～φ177.8-2.7m t=3.1mm',
		count : 10,
		intallDate : '2018/06/10',
		storgeDate : '2018/06/20',
	}, {
		name : '上管φ125～φ132-3.9m　t=3.1mm',
		count : 10,
		intallDate : '2018/06/10',
		storgeDate : '2018/06/20'
	} ]
}, {
	"id" : 12,
	"testNo" : 'XXXX012',
	"process" : 1,
	"testName" : "屋内試験10012",
	"intallName" : '住友　材子',
	"storgeName" : 'ポール部門',
	"creator" : 5,
	"department" : "ポール部門",
	"createDate" : "	2018/09/10",
	"updateDate" : "2018/09/25",
	"startTime" : '2018/06/11',
	"endTime" : '2018/06/20',
	"products" : [ {
		name : 'Lower tube φ117～φ177.8-2.7m t=3.1mm',
		count : 10,
		intallDate : '2018/06/10',
		storgeDate : '2018/06/20',
	}, {
		name : '上管φ125～φ132-3.9m　t=3.1mm',
		count : 10,
		intallDate : '2018/06/10',
		storgeDate : '2018/06/20'
	} ]
}, {
	"id" : 13,
	"testNo" : 'XXXX013',
	"process" : 1,
	"testName" : "M18-03 高野(ボール)パンザーマスト試験",
	"creator" : 5,
	"department" : "ポール部門",
	"intallName" : '住友　材子',
	"storgeName" : 'ポール部門',
	"createDate" : "	2018/10/18",
	"updateDate" : "2018/10/25",
	"startTime" : '2018/10/18',
	"endTime" : '2018/10/23',
	"products" : [ {
		name : 'Lower tube φ117～φ177.8-2.7m t=3.1mm',
		count : 10,
		intallDate : '2018/06/18',
		storgeDate : '2018/06/23',
	}, {
		name : '上管φ125～φ132-3.9m　t=3.1mm',
		count : 10,
		intallDate : '2018/06/18',
		storgeDate : '2018/06/23'
	} ]
}, {
	"id" : 14,
	"testNo" : 'XXXX014',
	"process" : 1,
	"testName" : "C18-03 佐藤(ボール)パンザーマスト再試験",
	"intallName" : '住友　材子',
	"storgeName" : 'ポール部門',
	"creator" : 5,
	"department" : "ポール部門",
	"createDate" : "	2018/10/19",
	"updateDate" : "2018/10/26",
	"startTime" : '2018/10/19',
	"endTime" : '2018/10/23',
	"products" : [ {
		name : 'Lower tube φ117～φ177.8-2.7m t=3.1mm',
		count : 10,
		intallDate : '2018/06/19',
		storgeDate : '2018/06/23',
	}, {
		name : '上管φ125～φ132-3.9m　t=3.1mm',
		count : 10,
		intallDate : '2018/06/19',
		storgeDate : '2018/06/23'
	} ]
}, {
	"id" : 15,
	"testNo" : 'XXXX015',
	"process" : 1,
	"testName" : "M11-03 金井(ボール)骨材ビン試験",
	"creator" : 5,
	"department" : "ポール部門",
	"intallName" : '住友　材子',
	"storgeName" : 'ポール部門',
	"createDate" : "	2018/10/20",
	"updateDate" : "2018/10/26",
	"startTime" : '2018/10/20',
	"endTime" : '2018/10/23',
	"products" : [ {
		name : 'Lower tube φ117～φ177.8-2.7m t=3.1mm',
		count : 10,
		intallDate : '2018/06/20',
		storgeDate : '2018/06/23',
	}, {
		name : '上管φ125～φ132-3.9m　t=3.1mm',
		count : 10,
		intallDate : '2018/06/20',
		storgeDate : '2018/06/23'
	} ]
}, {
	"id" : 15,
	"testNo" : 'XXXX016',
	"process" : 1,
	"testName" : "屋内試験10016",
	"creator" : 5,
	"department" : "ポール部門",
	"intallName" : '住友　材子',
	"storgeName" : 'ポール部門',
	"createDate" : "	2018/10/22",
	"updateDate" : "2018/10/25",
	"startTime" : '2018/10/22',
	"endTime" : '2018/10/25',
	"products" : [ {
		name : 'Lower tube φ117～φ177.8-2.7m t=3.1mm',
		count : 10,
		intallDate : '2018/06/22',
		storgeDate : '2018/06/25',
	}, {
		name : '上管φ125～φ132-3.9m　t=3.1mm',
		count : 10,
		intallDate : '2018/06/22',
		storgeDate : '2018/06/25'
	} ]
}, ];

var dataDevice2 = [ {
	manuFac : "共和電業",
	model : "圧縮",
	shape : "LC-1TF",
	number : "2",
	manufaNo : "YQ6325",
	managerNo : "LC-1TF-01",
	unit : "tonf",
	rating : 1
},

{
	manuFac : "共和電業",
	model : "圧縮",
	shape : "LC-2TA",
	number : "2",
	manufaNo : "D89983",
	managerNo : "LC-2TF",
	unit : "tonf",
	rating : 2
},

{
	manuFac : "共和電業",
	model : "圧縮",
	shape : "LC-5TE",
	number : "2",
	manufaNo : "AF5360",
	managerNo : "LC_5TE-01",
	unit : "tonf",
	rating : 5
},

{
	manuFac : "共和電業",
	model : "圧縮",
	shape : "LC-10TE",
	number : "2",
	manufaNo : "CA9024",
	managerNo : "LC-10TE-01",
	unit : "tonf",
	rating : 5
},

{
	manuFac : "共和電業",
	model : "圧縮",
	shape : "LC-10TF",
	number : "2",
	manufaNo : "CC0990",
	managerNo : "LC-10TF-01",
	unit : "tonf",
	rating : 5
},

{
	manuFac : "共和電業",
	model : "圧縮",
	shape : "LC-50TE",
	number : "2",
	manufaNo : "CC2456",
	managerNo : "LC-50TE-01",
	unit : "tonf",
	rating : 5
}, ]

// Ban có muốn lưu lại không
var MSG_SAVE_01 = "情報を保存します。宜しでしょうか？";
var MSG_SAVE_02 = "入力したデータを登録します。よろしいですか？";
var MSG_SAVE_03 = "フィードバックをします。よろしいですか。";
// message for 登録 button
var MSG_SAVE_04 = "入力したデータを登録します。よろしいですか。";

// Ban co muon xoa thi nghiem nay khong
var MSG_DEL_1 = "申請を削除します。削除すると復活できませんがよろしいですか。";

// se bat dau thi nghiem, ban dong y khong
var MSG_START_TEST = "試験を開始します。よろしいですか。";
// Se khong bat dau thi nghiem, ban dong y khong
var MSG_CANCEL_START_TEST = "試験を開始しません。よろしいですか。";
// Se huy bat dau thi nghiem, ban dong y khong
var MSG_DELETE_START_TEST = "試験の開始を取り消します。よろしいですか。";
// Se khong huy bat dau thi nghiem, ban dong y khong
var MSG_CANDEL_DELETE_START_TEST = "試験開始を取消しません。よろしいですか。";
var MSG_REGIST_OVER = "選択した機器台数は使用可能台数を超えました。申請しますがよろしいですか。"

// se ket thuc thi nghiem, ban dong y khong
var MSG_STOP_TEST = "試験を終了します。よろしいですか。";
// Se khong ket thuc thi nghiem, ban dong y khong
var MSG_CANCEL_STOP_TEST = "試験を終了しません。よろしいですか。";
// Se huy ket thuc thi nghiem, ban dong y khong
var MSG_DELETE_STOP_TEST = "試験の終了を取り消します。よろしいですか。";
// Se khong huy ket thuc thi nghiem, ban dong y khong
var MSG_CANDEL_DELETE_STOP_TEST = "試験終了を取消しません。よろしいですか。";

var MSG_DELTE_01 = "削除します。よろしいでしょうか？";
var MSG_CANCEL_01 = "試験を消し取りしますか？";
var MSG_CANCEL_02 = "削除します。よろしいですか？";

var MSG_SIGN_IN = "試験を申請しますか？";
var MSG_APPLY_09 = "申請します。よろしいですか。";
var MSG_APPROVE_CONFIRM_09 = "申請を承認します。よろしいですか。";
var MSG_REJECT_CONFIRM_09 = "申請を差し戻しします。よろしいですか。";
var MSG_REJECT_SPECIAL_CONFIRM_09 = "申請を差し戻しします（特別）。よろしいですか。";
var MSG_DEL_TYPE_MUTIFILE = "選択したファイルを削除します。よろしいですか？";
var MSG_DEL_TYPE_SINGLE = "ファイルを更新します。よろしいでしょうか？";
var MSG_REGIS_MATERIAL = "追加申請します。よろしいですか。";
var MSG_REGIS_ACCEPT = "承認します。よろしいですか。";
var MSG_REGIS_REJECT = "却下します。よろしいですか。";

var MSG_CONFIRM_NEXT_PAGE = "未保存のデータがあります。保存しますか？";
var MSG_CONFIRM_SEND_MAIL = "警告メールを送信します。よろしいですか。";
var CLOSE_CONFIRM = "未保存のデータがあります。保存しますか？";

var MSG_REQUEST_ITEM_ATTACH_DRAWING = "図面を添付してください。";

var MSG_REQUEST_ITEM_UPDATE_PROFILE = "受講者の所属、氏名、生年月日（西暦）を記入してください。";

var MSG_REQUEST_ITEM_CUSTOMER_REPLY = "特定工場見学許可伺いを提出してください。";

var MSG_REQUEST_ITEM_EXIST_CHOICE = "この選択は既に選択されました！";

var MSG_LIST_TEST_REMOVE_IF_SEARCHING = "検索条件と表示しているデータをクリアします。よろしいですか？";

var MSG_INVALID_DATE= "日付形式（YYYY/MM/DD）で入力してください。";

var MSG_INVALID_DATE_FROM_AND_TO = "開始日≦終了日となるように設定してください。";

var MSG_EXPORT_CSV = "CSV出力年月を入力してください。";
$(document).ready(function(e) {
	$(".data-date").each(function(e) {
		dateFormatInput($(this), "yy/mm/dd");
	});

	$('.data-date').attr('autocomplete', 'off');

	scrollTop();
	var x = window.location.pathname.split('/')[1];
	var y = window.location.pathname.split('/')[2];
	if (x === 'fled23' || y === 'fled23') {
		var contentFled23 = $('#content').val();
		if (contentFled23 && contentFled23.length > 20) {
			$('#content').val(contentFled23.slice(0, 20));
		}
	}
	// restrictDateInputFormat();

	// disabled right click in tag
	disableRightClick("a");

});

var MSG_FLED_19 = {
	MSG_TIME_FROM_GREATER_ERR : "開始日≦終了日となるように設定してください。",

}

String.prototype.startsWith || (String.prototype.startsWith = function(word) {
	return this.lastIndexOf(word, 0) === 0;
});

String.prototype.endsWith || (String.prototype.endsWith = function(word) {
	return this.indexOf(word, this.length - word.length) !== -1;
});

function getUrlParameter(sParam) {
	var sPageURL = decodeURIComponent(window.location.search.substring(1)), sURLVariables = sPageURL.split('&'), sParameterName, i;

	for (i = 0; i < sURLVariables.length; i++) {
		sParameterName = sURLVariables[i].split('=');

		if (sParameterName[0] === sParam) {
			return sParameterName[1] === undefined ? true : sParameterName[1];
		}
	}
};

function findHistoryById(id) {
	for (var i = 0; i < dataHistory.length; i++) {
		if (dataHistory[i].id == id) {
			return dataHistory[i];
		}
	}

	return null;
}

function disableRightClick(target) {
	$(target).on("contextmenu", function(e) {
		e.preventDefault();
		return false;
	});
}

function formatDate(str) {
	var args = str.split("/");
	return args[0] + "年" + args[1] + "月" + args[2] + "日";
}

function dateFormatInput(target, format) {
	var monthNames = [ '1月', '2月', '3月', '4月', '5月', '6月', '7月', '8月', '9月', '10月', '11月', '12月' ];
	var monthNamesShort = [ '1月', '2月', '3月', '4月', '5月', '6月', '7月', '8月', '9月', '10月', '11月', '12月' ];
	var dayNames = [ '日', '月', '火', '水', '木', '金', '土' ];
	var dayNamesShort = [ '日', '月', '火', '水', '木', '金', '土' ];
	$(target).datepicker({
		monthNames : monthNames,
		monthNamesShort : monthNamesShort,
		dayNamesMin : dayNames,
		dateFormat : format
	});
}

function createZero(value, length) {
	var length = length - ("" + value).length;
	for (var i = 0; i < length; i++) {
		value = "0" + value;
	}
	return value;
}

function toggleModal(target) {
	$(target).modal('toggle');
}

function find(data, name, value) {
	var result = {};
	for (var i = 0; i < data.length; i++) {
		if (data[i][name] == value) {
			result = data[i];
			result.index = i;
			break;
		}
	}
	return result;
}

function formatTimeNow() {
	var date = new Date();
	return date.getFullYear() + "/" + createZero(date.getMonth() + 1, 2) + "/" + createZero(date.getDate(), 2) + " " + createZero(date.getHours(), 2) + ":" + createZero(date.getMinutes(), 2);
}

function formatTime(input) {
	var date;
	if(undefined == input || null == input || "" == input){
		date = new Date(); 
	}else{
		date = new Date(input);
	}
	return date.getFullYear() + "/" + createZero(date.getMonth() + 1, 2) + "/" + createZero(date.getDate(), 2) + " " + createZero(date.getHours(), 2) + ":" + createZero(date.getMinutes(), 2);
}


function initData() {
	var data = [];
	data.push({
		manuFac : "東京測器",
		model : "ロッド",
		shape : "CDP-25",
		number : "5",
		manufaNo : "BBC 09229",
		managerNo : "CDP-25-01",
		id : 1,
		unit : 'tonf',
		rating : 40,
	});
	data.push({
		manuFac : "東京測器",
		model : "ロッド",
		shape : "SDP-50R",
		number : "5",
		manufaNo : "BBC 09231",
		managerNo : "CDP-25-03",
		id : 2,
		unit : 'tonf',
		rating : 40,
	});

	data.push({
		manuFac : "東京測器",
		model : "ロッド",
		shape : "SDP-50CS",
		number : "5",
		manufaNo : "BBC 09232",
		managerNo : "CDP-25-04",
		id : 3,
		unit : 'tonf',
		rating : 40,
	});

	data.push({
		manuFac : "東京測器",
		model : "ロッド",
		shape : "SDP-100R",
		number : "5",
		manufaNo : "BBC 09257",
		managerNo : "CDP-25-05",
		id : 4,
		unit : 'tonf',
		rating : 40,
	});
	return data;
}

function initGroup() {
	var list = [];
	var item = {
		name : '東京測器',
		modelNames : [ "ロッド", "巻き取り式", "カンチレバー式", "引張", "引張", "圧縮引張" ],
		model : [ {
			name : 'ロッド',
			shape : [ "CDP-25", "SDP-50R", "SDP-50CS", "CDP-50", "SDP-100R", "SDP-200D" ]
		}, {
			name : '巻き取り式',
			shape : [ "DP-500E", "DP-1000B", "DP-1000C" ]
		}, {
			name : 'カンチレバー式',
			shape : [ "CE-10" ]
		},//
		{
			name : '引張',
			shape : [ "TLP-5B", "TLP-50kNB" ]
		}, {
			name : '引張',
			shape : [ "CLP-5S", "CLP-50CM", "CLP-50B", "CLP-200", "CLC-5A", "CLC-20A", "CLF-200", "KCM-200KNA", "KC-100A" ]
		}, {
			name : '圧縮引張',
			shape : [ "TCLP-1MNB", "TCLP-50k NB", "TCLP-300k NB" ]
		}

		]
	};
	list.push(item);
	item = {
		name : 'キーエンス',
		modelNames : [ "レーザー" ],
		model : [ {
			name : 'レーザー',
			shape : [ "IL-S025", "IL-S100", "IL-300", "IL-600", "IL-2000" ]
		} ]
	};

	list.push(item);
	item = {
		name : '共和電業',
		modelNames : [ "圧縮" ],
		model : [ {
			name : '圧縮',
			shape : [ "LC-1TF", "LC-2TA", "LC-5TE", "LC-10TE", "LC-10TF", "LC-50TE" ]
		} ]
	};

	list.push(item);
	return list;
}

function findMax(data, name) {
	var max = -1;
	for (var i = 0; i < data.length; i++) {
		if (data[i][name] > max) {
			max = data[i][name];
		}
	}
	return max;
}

function formatNumberAddDotZero(number) {
	number = number + '';
	if (number.split('.').length == 1) {
		number += ".0";
	}
	return number;
}

function scrollTop() {
	var $_top = $("#scrollTop");
	// if(!$_top) {
	// var html = "<div id='scrollTop'>";
	// html += "<span>";
	// html += "<i class='fa fa-arrow-up' aria-hidden='true'></i>";
	// html += "</span>";
	// html += "</div>";
	// $(html).appendTo('body');
	// }
	// $_top = $("#scrollTop");
	if ($_top) {
		$(window).scroll(function() {
			var e = $(window).scrollTop();
			if (e > 300) {
				$_top.show();
			} else {
				$_top.hide();
			}
		});
	}
	$_top.on('click', function() {
		$('body,html').animate({
			scrollTop : 0
		});
	});
}

String.prototype.replaceAll = function(search, replacement, usingRegex) {
	var target = this;
	if (usingRegex === null || usingRegex === undefined || usingRegex === true) {
		return target.replace(new RegExp(search, 'g'), replacement);
	}
	return target.split(search).join(replacement);
};

function setFieldError(selector) {
	var $selector = (selector instanceof $) ? selector : $(selector);
	if (!$selector.hasClass('input-error')) {
		$selector.addClass('input-error');
	}
}

function clearInputErrors() {
	$('.error.group-error').html("");
	$('.input-error').each(function() {
		$(this).removeClass('input-error');
	});
}

function secureXSS(text) {
	return !text ? "" : filterXSS(text);
}

function isHalfWidth(c) {
	return eaw.length(c) == 1;
}

function restrictDateInputFormat(selector) {
	!selector && (selector = '.data-date');
	var $selector = (selector instanceof $) ? selector : $(selector);
	$selector.each(function() {
		setDateInputFilter($(this), function(value) {
			return !value || moment(value, AppConstants.DATE_FORMAT.JS_YYYY_MM_DD, true).isValid();
		});
	});
}

function getProgressApp(process) {
	switch (process) {
	case AppConstants.TEST_STATUS.CREATE:
		return "作成中";
	case AppConstants.TEST_STATUS.SUBMIT:
		return "申請中";
	case AppConstants.TEST_STATUS.C_LEADER_APPROVE:
		return "一次承認";
	case AppConstants.TEST_STATUS.C_MANAGER_APPROVE:
		return "二次承認";
	case AppConstants.TEST_STATUS.REJECT:
		return "差し戻し";
	case AppConstants.TEST_STATUS.F_RECEIVER:
		return "受付済";
	case AppConstants.TEST_STATUS.F_CONFIRM:
		return "確認済";
	case AppConstants.TEST_STATUS.F_LEADER_APPROVE:
		return "G長承認";
	case AppConstants.TEST_STATUS.F_MANAGER_APPROVE:
		return "最終承認";
	case AppConstants.TEST_STATUS.START:
		return "試験開始";
	case AppConstants.TEST_STATUS.END:
		return "試験終了";
	}
	return "";
}

function isIE() {
	var isIE = /* @cc_on!@ */false || !!document.documentMode;
	return isIE;
}

function showConfirmDialog(confirmMsg, method1, method2) {
	$.dialogbox({
		type : 'msg',
		title : '確認',
		content : confirmMsg,
		closeBtn : true,
		btn : [ 'はい', 'いいえ' ],
		call : [ function() {
			if (typeof method1 == 'function') {
				method1();
			}
			$.dialogbox.close();
		}, function() {
			if (typeof method2 == 'function') {
				method2();
			}
			$.dialogbox.close();
		} ]
	});
}

function nextPageCommon(method1, method2, method3) {
	$.dialogbox({
		type : 'msg',
		title : '確認',
		content : MSG_CONFIRM_NEXT_PAGE,
		closeBtn : true,
		btn : [ '保存', '保存しない', 'キャンセル' ],
		call : [ function() {
			if (typeof method1 == 'function') {
				method1();
			}
			$.dialogbox.close();
		}, function() {
			if (typeof method2 == 'function') {
				method2();
			}
			$.dialogbox.close();
		}, function() {
			if (typeof method3 == 'function') {
				method3();
			}
			$.dialogbox.close();
		} ]
	});
};

function showAlertDialog(msg, type) {
	$.dialogbox({
		type : 'msg',
		title : (type == 'error' ? 'エラー' : '情報'),
		content : msg,
		maxWidth : 400,
		closeBtn : true,
		btn : [ 'OK' ],
		call : [ function() {
			$.dialogbox.close();
		}, function() {
			$.dialogbox.close();
		} ]
	});
}

function showStyledDebug(text, appendTxt, timeout) {
	appendTxt = appendTxt || false;
	var $styledDebug = $('.debugd');
	if ($styledDebug.length) {
		appendTxt ? $styledDebug.append(text) : $styledDebug.html(text);
		$styledDebug.show();
	} else {
		$('body').append('<div class="debugd">' + text + '</div>');
		$styledDebug = $('.debugd');
	}
	if (timeout) {
		setTimeout(function() {
			$styledDebug.hide();
		}, timeout);
	}
}

function changeSelected(selector, val) {
	$(selector + " option:selected").removeAttr("selected");
	$(selector + " option[value='" + val + "']").attr('selected', 'selected');
}

function isNotEmpty(str) {
	return str && str.trim().length !== 0;
}

function applyMsgParam(str, index, param) {
	if ($.isArray(index)) {
		for (var ii = 0; ii < index.length; ii++) {
			var indez = index[ii];
			if (indez === 0) {
				str = str.replace(/\{0\}/, param[ii]);
			} else if (indez === 1) {
				str = str.replace(/\{1\}/, param[ii]);
			} else if (indez === 2) {
				str = str.replace(/\{2\}/, param[ii]);
			} else if (indez === 3) {
				str = str.replace(/\{3\}/, param[ii]);
			} else {
				str = str.replace(/\{4\}/, param[ii]);
			}
		}
		return str;
	} else {
		if (index === 0) {
			return str.replace(/\{0\}/, param);
		}
		if (index === 1) {
			return str.replace(/\{1\}/, param);
		}
		if (index === 2) {
			return str.replace(/\{2\}/, param);
		}
		if (index === 3) {
			return str.replace(/\{3\}/, param);
		}
	}
	return str.replace(/\{4\}/, param);
}

function decimalFormat(number, precition) {
	var numberStr = Number(number).toFixed(precition) + '';
	for (var ii = numberStr.length - 1; ii > 0; ii--) {
		if (numberStr[ii] === '0') {
			if (numberStr[ii - 1] === '.') {
				return numberStr.substr(0, numberStr.length - 2);
			}
			numberStr = numberStr.substr(0, numberStr.length - 1);
		} else {
			break;
		}
	}
	return numberStr;
}

function isValidDate(text, dateRequired) {
	dateRequired = dateRequired || false;
	return dateRequired ? moment(text, AppConstants.DATE_FORMAT.JS_YYYY_MM_DD, true).isValid() : (!text || moment(text, AppConstants.DATE_FORMAT.JS_YYYY_MM_DD, true).isValid());
}

function setTextInputFilter(textbox, inputFilter) {
	[ "input", "keydown", "keyup", "mousedown", "mouseup", "select", "contextmenu", "drop" ].forEach(function(event) {
		textbox.unbind(event);
		textbox.on(event, function() {
			if (inputFilter(this.value, this)) {
				this.oldValue = this.value;
				this.oldSelectionStart = this.selectionStart;
				this.oldSelectionEnd = this.selectionEnd;
			} else if (this.hasOwnProperty("oldValue")) {
				this.value = this.oldValue;
				this.setSelectionRange(this.oldSelectionStart, this.oldSelectionEnd);
			} else {
				this.value = "";
			}
		});
	});
};

function setNumberInputFilter(textbox, inputFilter, blurFilter) {
	[ "input", "keydown", "keyup" ].forEach(function(event) {
		textbox.unbind(event);
		textbox.on(event, function() {
			if (inputFilter(this.value, this)) {
				this.oldValue = this.value;
				this.oldSelectionStart = this.selectionStart;
				this.oldSelectionEnd = this.selectionEnd;
			} else if (this.hasOwnProperty("oldValue")) {
				this.value = this.oldValue;
				this.setSelectionRange(this.oldSelectionStart, this.oldSelectionEnd);
			} else {
				this.value = "";
			}
		});
	});
	[ "blur" ].forEach(function(event) {
		textbox.unbind(event);
		textbox.on(event, function() {
			if (blurFilter(this.value, this)) {
				this.oldValue = this.value;
				this.oldSelectionStart = this.selectionStart;
				this.oldSelectionEnd = this.selectionEnd;
			} else {
				this.value = "";
			}
		});
	});
}

function setDateInputFilter(textbox, inputFilter) {
	[ "blur" ].forEach(function(event) {
		textbox.unbind(event);
		textbox.on(event, function() {
			if (inputFilter(this.value)) {
				this.oldValue = this.value;
				this.oldSelectionStart = this.selectionStart;
				this.oldSelectionEnd = this.selectionEnd;
			} else {
				this.value = "";
			}
		});
	});
};

function backToPortalWithoutSave() {
	window.location = rootURL;
}

function backToPortal(isStateChanged, saveAndOpenPage) {
	backToPrevPage(isStateChanged, saveAndOpenPage, "00", rootURL);
}

function backToPrevPage(isStateChanged, saveAndOpenPage, pageCode, pageURL) {
	if (isStateChanged) {
		if (isStateChanged()) {
			nextPageCommon(function() {
				saveAndOpenPage(pageCode);
			}, function() {
				window.location = pageURL;
			}, null);
		} else {
			window.location = pageURL;
		}
	} else {
		window.location = pageURL;
	}
}

function backToPrevPageForFled16(isStateChanged, saveAndOpenPage, pageCode) {
	if (isStateChanged) {
		if (isStateChanged()) {
			nextPageCommon(function() {
				saveAndOpenPage(pageCode);
				backPreviousPage();
			}, function() {
				backPreviousPage();
			}, null);
		} else {
			backPreviousPage();
		}
	} else {
		backPreviousPage();
	}
}

function getScrollBarWidth() {
	var inner = document.createElement('p');
	inner.style.width = "100%";
	inner.style.height = "200px";

	var outer = document.createElement('div');
	outer.style.position = "absolute";
	outer.style.top = "0px";
	outer.style.left = "0px";
	outer.style.visibility = "hidden";
	outer.style.width = "200px";
	outer.style.height = "150px";
	outer.style.overflow = "hidden";
	outer.appendChild(inner);

	document.body.appendChild(outer);
	var w1 = inner.offsetWidth;
	outer.style.overflow = 'scroll';
	var w2 = inner.offsetWidth;
	if (w1 == w2)
		w2 = outer.clientWidth;

	document.body.removeChild(outer);

	return (w1 - w2);
};

function getSubmitDataJson(selector) {
	var formData = new FormData($(selector)[0]);

	var jsonData = {};

	$(selector + ' input').each(function() {
		var $this = $(this);
		var inputName = $this.attr('name');
		if ($this.attr('type') === 'hidden') {
			jsonData[inputName] = $this.val();
		} else if ($this.is(':visible') && !$this.is(':hidden')) {
			jsonData[inputName] = $this.val();
		}
	});

	$(selector + ' input[type="checkbox"]').each(function() {
		var chkName = $(this).attr('name');
		if ($(selector + ' input[type="hidden"][name="_' + chkName + '"]').length) {
			if (jsonData['_' + chkName]) {
				delete jsonData['_' + chkName];
			}
			jsonData[chkName] = $(this).is(':checked') ? AppConstants.STR_CHECKED : AppConstants.STR_UNCHECKED;
		}
	});

	$(selector + ' select').each(function() {
		var $this = $(this);
		var inputName = $this.attr('name');
		if ($this.is(':visible') && !$this.is(':hidden')) {
			jsonData[inputName] = $this.val();
		}
	});

	return jsonData;
}

function clearErrorOnInputEvt(inputSelector) {
	inputSelector = inputSelector ? inputSelector : 'input[type="text"], input[type="number"], textarea, select';
	$(document).on("change", inputSelector, function(e) {
		if ($(this).hasClass('input-error')) {
			$(this).removeClass('input-error');
		}
	});
	$(document).on("input keydown keyup select", inputSelector, function(e) {
		if ($(this).hasClass('input-error')) {
			$(this).removeClass('input-error');
		}
	});
}

function randomIdStr(length) {
	var firstChr = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";
	var possible = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";
	var text = firstChr.charAt(Math.floor(Math.random() * possible.length));
	for (var i = 0; i < length - 1; i++) {
		text += possible.charAt(Math.floor(Math.random() * possible.length));
	}
	return text;
}

$(document).ready(function() {
	$.uiSave = {
		defaultOptions : {
			fileTagId : true,
			/*
			 * 'file', 'custom'
			 */
			aCollect : 'file',
			/*
			 * Using where aCollect = 'custom'
			 */
			aCollectFunction : null
		},
		jqueryWrapDom : function(doms) {
			if (doms) {
				if ($.isArray(doms)) {
					for (var ii = 0; ii < doms.length; ii++) {
						doms[ii] = (doms[ii] instanceof $) ? doms[ii] : $(doms[ii]);
					}
				} else {
					doms = (doms instanceof $) ? doms : $(doms);
				}
			}
			return doms;
		},
		collectData : function(uiStoreData, excludeDoms, incMoreDoms, options) {
			$('input, select, textarea').each(function() {
				var $currCtlThis = $(this), ctlItemType = ($currCtlThis.attr('type') + "").toLowerCase(), ctlItemPushable = true;
				if ($currCtlThis.prop("tagName") !== 'INPUT' || 'hidden' !== ctlItemType) {
					if (excludeDoms) {
						if ($.isArray(excludeDoms)) {
							for (var ii = 0; ii < excludeDoms.length; ii++) {
								excludeDoms[ii].each(function() {
									if ($currCtlThis[0] == $(this)[0] || $currCtlThis.hasAncestor(this)) {
										ctlItemPushable = false;
									}
								});
							}
						} else {
							excludeDoms.each(function() {
								ctlItemPushable = ctlItemPushable && !($currCtlThis[0] == $(this)[0] || $currCtlThis.hasAncestor(this));
							});
						}
					}
					if (ctlItemPushable) {
						uiStoreData.push({
							tagId : (ctlItemType === 'file' && !options.fileTagId ? '' : $currCtlThis.attr('id')),
							tagName : $currCtlThis.prop("tagName"),
							inputType : ctlItemType,
							inputValue : ((ctlItemType === 'checkbox' || ctlItemType === 'radio') ? $currCtlThis.is(':checked') : $currCtlThis.val()),
							selectText : (($currCtlThis.prop("tagName") !== 'SELECT') ? "" : $currCtlThis.find('option:selected').text())
						});
					}
				}
			});
			if (incMoreDoms) {
				if ($.isArray(incMoreDoms)) {
					for (var ii = 0; ii < incMoreDoms.length; ii++) {
						incMoreDoms[ii].each(function() {
							var $currCtlThis = $(this), ctlItemType = ($currCtlThis.attr('type') + "").toLowerCase();
							if ($currCtlThis.prop("tagName") === 'A') {
								if (options.aCollect === 'file') {
									uiStoreData.push({
										tagId : $currCtlThis.attr('id'),
										tagName : $currCtlThis.prop("tagName"),
										inputType : '',
										inputValue : $currCtlThis.text().trim(),
										selectText : ''
									});
								} else if (options.aCollectFunction) {
									uiStoreData.push(options.aCollectFunction($currCtlThis));
								}
							} else if ($currCtlThis.prop("tagName") === 'INPUT' || 'hidden' === ctlItemType) {
								uiStoreData.push({
									tagId : $currCtlThis.attr('id'),
									tagName : $currCtlThis.prop("tagName"),
									inputType : ctlItemType,
									inputValue : $currCtlThis.val(),
									selectText : ""
								});
							} else if ($currCtlThis.prop("tagName") !== 'INPUT' && $currCtlThis.prop("tagName") !== 'SELECT' && $currCtlThis.prop("tagName") !== 'TEXTAREA') {
								uiStoreData.push({
									tagId : $currCtlThis.attr('id'),
									tagName : $currCtlThis.prop("tagName"),
									inputType : "",
									inputValue : $currCtlThis.attr('class'),
									selectText : $currCtlThis.text()
								});
							}
						});
					}
				} else {
					incMoreDoms = (incMoreDoms instanceof $) ? incMoreDoms : $(incMoreDoms);
					incMoreDoms.each(function() {
						var $currCtlThis = $(this), ctlItemType = ($currCtlThis.attr('type') + "").toLowerCase();
						if ($currCtlThis.prop("tagName") === 'A') {
							if (options.aCollect === 'file') {
								uiStoreData.push({
									tagId : $currCtlThis.attr('id'),
									tagName : $currCtlThis.prop("tagName"),
									inputType : '',
									inputValue : $currCtlThis.text().trim(),
									selectText : ''
								});
							} else if (options.aCollectFunction) {
								uiStoreData.push(options.aCollectFunction($currCtlThis));
							}
						} else if ($currCtlThis.prop("tagName") === 'INPUT' || 'hidden' === ctlItemType) {
							uiStoreData.push({
								tagId : $currCtlThis.attr('id'),
								tagName : $currCtlThis.prop("tagName"),
								inputType : ctlItemType,
								inputValue : $currCtlThis.val(),
								selectText : ""
							});
						} else if ($currCtlThis.prop("tagName") !== 'INPUT' && $currCtlThis.prop("tagName") !== 'SELECT' && $currCtlThis.prop("tagName") !== 'TEXTAREA') {
							uiStoreData.push({
								tagId : $currCtlThis.attr('id'),
								tagName : $currCtlThis.prop("tagName"),
								inputType : "",
								inputValue : $currCtlThis.attr('class'),
								selectText : $currCtlThis.text()
							});
						}
					});
				}
			}
		},
		parseOptions : function(options) {
			options = options ? options : this.defaultOptions;
			this.options = $.extend(true, {}, this.defaultOptions, options);
		},
		saveState : function(excludeDoms, incMoreDoms, options) {
			var _self = this;
			this.parseOptions(options);
			excludeDoms = this.jqueryWrapDom(excludeDoms);
			incMoreDoms = this.jqueryWrapDom(incMoreDoms);
			setTimeout(function() {
				$.uiFormData = [];
				_self.collectData($.uiFormData, excludeDoms, incMoreDoms, _self.options);
			}, 200);
		},
		isStateChanged : function(excludeDoms, incMoreDoms, options) {
			this.parseOptions(options);
			excludeDoms = this.jqueryWrapDom(excludeDoms);
			incMoreDoms = this.jqueryWrapDom(incMoreDoms);
			$.currUiFormData = [];
			this.collectData($.currUiFormData, excludeDoms, incMoreDoms, this.options);
			if ($.uiFormData.length !== $.currUiFormData.length) {
				return true;
			}
			for (var ii = 0; ii < $.uiFormData.length; ii++) {
				if ($.uiFormData[ii].tagId !== $.currUiFormData[ii].tagId || $.uiFormData[ii].tagName !== $.currUiFormData[ii].tagName || $.uiFormData[ii].inputType !== $.currUiFormData[ii].inputType || $.uiFormData[ii].inputValue !== $.currUiFormData[ii].inputValue || $.uiFormData[ii].selectText !== $.currUiFormData[ii].selectText) {
					console.log($.uiFormData[ii]);
					console.log($.currUiFormData[ii]);
					return true;
				}
			}
			return false;
		}
	};

	$.fn.hasScrollBar = function() {
		return this.get(0).scrollHeight > this.height();
	};

	$.fn.showLoading = function() {
		var $this = (this instanceof $) ? this : $(this);
		var $loading = $this.find('.mloading');
		if (!$loading.length) {
			$this.append('<div class="mloading"><div class="mloader"></div></div>');
		}
	}

	$.parseCssVal = function(cssVal) {
		if (cssVal.endsWith('px')) {
			var cssValue = cssVal.substring(0, cssVal.length - 2);
			if ($.isNumeric(cssValue)) {
				return parseFloat(cssValue);
			}
		}
		return (cssVal === null || cssVal === undefined) ? 0 : (cssVal === 'auto' ? 0 : cssVal);
	}

	$.fn.closeLoading = function() {
		var $this = (this instanceof $) ? this : $(this);
		var $loading = $this.find('.mloading');
		if ($loading.length) {
			$loading.remove();
		}
	}

	$.fn.defaultScroll = function(options) {
		if (!window.scrollBarWidth) {
			window.scrollBarWidth = getScrollBarWidth();
		}
		this.css({
			'overflow' : 'hidden',
			'position' : 'relative'
		});
		options.mainObj.css({
			'overflow' : 'hidden',
			'height' : '100%',
			'position' : 'relative'
		});
		options.usingTop = options.usingTop || true;

		var $scrollDiv = this.find('.scrolldiv'), scrollHeight = (options.mainObj.children().eq(0).height() + 1);
		if (!$scrollDiv.length) {
			this.append('<div class="scrolldiv" style="width: ' + (window.scrollBarWidth + 1) + 'px">' + '<div class="scrollitem" style="width: ' + window.scrollBarWidth + 'px; height: ' + scrollHeight + 'px"></div>' + '</div>');
		} else {
			$scrollDiv.find('.scrollitem').css('height', scrollHeight + 'px');
		}
		$scrollDiv = this.find('.scrolldiv');
		$scrollDiv.unbind('scroll');
		$scrollDiv.scroll(function(evt) {
			if (options.usingTop) {
				options.mainObj.css('top', (-$(this).scrollTop()) + 'px');
			} else {
				options.mainObj.scrollTop($(this).scrollTop());
			}
		});
		options.mainObj.unbind('scroll');
		options.mainObj.scroll(function(evt) {
			$scrollDiv.scrollTop($(this).scrollTop());
		});
		options.mainObj.on('mousewheel', function(event) {
			event.preventDefault();
			if (options.usingTop) {
				var mWheelVal = ($.parseCssVal(options.mainObj.css('top')) + 15 * event.deltaY);
				mWheelVal = Math.max($scrollDiv.outerHeight() - $scrollDiv.prop("scrollHeight") + 1, Math.min(0, mWheelVal));
				$scrollDiv.scrollTop(-mWheelVal);
				options.mainObj.css('top', mWheelVal + 'px');
			} else {
				var mWheelVal = (options.mainObj.scrollTop() + 15 * event.deltaY);
				$scrollDiv.scrollTop(mWheelVal);
				options.mainObj.scrollTop(mWheelVal);
			}
		});
	};

	$.fn.findParent = function(tagName, props) {
		tagName = tagName.toUpperCase();
		var $this = (this instanceof $) ? this : $(this);
		var $parent = $this.parent();
		while ($parent && $parent.prop('tagName')) {
			if ($parent.prop('tagName') === tagName) {
				var propMatched = true;
				if (props) {
					for ( var property in props) {
						if (props.hasOwnProperty(property)) {
							if (props[property] !== $parent.attr(property)) {
								propMatched = false;
								break;
							}
						}
					}
				}
				if (propMatched) {
					return $parent;
				}
			}
			$parent = $parent.parent();
		}
		return null;
	};

	$.fn.hasAncestor = function(element) {
		var $ancThis = (this instanceof $) ? this : $(this);
		var $ancElement = (element instanceof $) ? element : $(element);
		var $ancParent = $ancThis.parent();
		while ($ancParent && $ancParent.prop('tagName')) {
			if ($ancParent[0] == $ancElement[0]) {
				return true;
			}
			$ancParent = $ancParent.parent();
		}
		return false;
	};

	window.winResizeFunc1 = function() {
		if ($('.scrollfix').length && !$('body').hasScrollBar()) {
			if (!window.scrollBarWidth) {
				window.scrollBarWidth = getScrollBarWidth();
			}
			$('.scrollfix').css('max-width', ($(window).width() - window.scrollBarWidth - 2) + 'px');
		}
	};

	window.scrResizeData = {};

	function threadResizeSCR(idThread) {
		window.winResizeFunc1 && window.winResizeFunc1();
		window.winResizeFunc2 && window.winResizeFunc2();
		if (++window.scrResizeData[idThread].step === 3) {
			clearInterval(window.scrResizeData[idThread].realId);
			delete window.scrResizeData[idThread];
		}
	}

	window.winResizeFunc1 && window.winResizeFunc1();
	window.winResizeFunc2 && window.winResizeFunc2();

	$(window).on('resize', function() {
		let
		threadId = randomIdStr(10);
		window.scrResizeData[threadId] = {
			step : 0
		};
		window.scrResizeData[threadId].realId = setInterval(function() {
			threadResizeSCR(threadId);
		}, 500);
	});
	// vandd
	$(".dateStart").change(function() {
		var value = $(this).val();
		var data_date_id = $(this).attr("data-date");

		if (isValidDate(value) && data_date_id) {
			var date = $(this).datepicker('getDate');
			$(".dateEnd[data-date=" + data_date_id + "]").datepicker("setDate", date);
		}
	});

	function replaceJsonErrors(key, value) {
		if (value instanceof Error) {
			var error = {};

			Object.getOwnPropertyNames(value).forEach(function(key) {
				error[key] = value[key];
			});
			return error;
		}
		return value;
	}

	window.onerror = function(msg, url, line) {
		try {
			if ($ && rootURL) {
				$.post(rootURL + "/jserror", {
					msg : JSON.stringify({
						'msg' : msg,
						'url' : url,
						'line' : line
					})
				}, function(data, status) {
				});
			}
		} catch (err) {
		}
	};

	$.logJsError = function(error, extObj) {
		try {
			if (rootURL) {
				if (console && console.error) {
					console.error(error);
				}
				var logMsg = JSON.stringify(error, replaceJsonErrors);
				if (extObj) {
					if (typeof extObj === 'string' || extObj instanceof String) {
						logMsg += "\n" + extObj;
					} else if (extObj instanceof $) {
						logMsg += "\n" + JSON.stringify({id: extObj.attr('id'), className: extObj.prop('className'), val: extObj.val(), text: extObj.text()});
					} else {
						logMsg += "\n" + JSON.stringify(extObj);
					}
				}
				$.post(rootURL + "/jserror", {
					msg : logMsg
				}, function(data, status) {
				});
			}
		} catch (err) {
		}
	};
});
var NOTHING_SELECTED_VALUE = "Nothing Selected";

// check lượng kí tự của textarea. Chỉ cần thêm onkeyup="change(this)"
function change(el) {
	var max_len = 20;
	if (el.value.length > max_len) {
		el.value = el.value.substr(0, max_len);
	}
	document.getElementById('char_cnt').innerHTML = el.value.length;
	document.getElementById('chars_left').innerHTML = max_len - el.value.length;
}

/**
 * Dung ham nay de tu dong genra format yyyy/MM//dd khi nguoi dung input vao cac o ngay thang
 * 
 * @param dom
 */
var key = 0;
function genDataDate(dom) {
	var value = dom.value;

	$(document).off('keydown').keydown(function(e) {
		key = e.which;
	});

	if (value.length == 4 && key != 8) {
		value += "/";
	}

	if (value.length == 7 && key != 8) {
		var month = Number(value.substr(5, 2));
		if (month > 12) {
			value = value.substr(0, 5) + "12";
		}
		if (month < 1) {
			value = value.substr(0, 5) + "01";
		}
		value += "/";
	}
	if (value.length == 10) {
		var day = Number(value.substr(8, 2));
		if (day > 31) {
			value = value.substr(0, 8) + "31";
		}
		if (day < 01) {
			value = value.substr(0, 8) + "01";
		}
	}
	dom.value = value;
}

function genDataMonth(dom) {
	var value = dom.value;

	$(document).off('keydown').keydown(function(e) {
		key = e.which;
	});

	if (value.length == 4 && key != 8) {
		value += "/";
	}

	if (value.length == 7 && key != 8) {
		var month = Number(value.substr(5, 2));
		if (month > 12) {
			value = value.substr(0, 5) + "12";
		}
		if (month < 1) {
			value = value.substr(0, 5) + "01";
		}
	}
	dom.value = value;
}

function formatDataDate(dom) {
	var value = dom.value;
	if (value.length == 9) {
		value = value.substr(0, 8) + "0" + value.substr(8, 1);
	}
	dom.value = value;
}

/**
 * Hàm disable các ô input hay select box trong 1 màn (only view)
 */
function disableAllInputField() {
	// // disable o input
	// $("input").prop('disabled', true);
	// // disable select picker
	// $('.selectpicker').attr('disabled', true);
	// // disable text area
	// $("textarea").prop('disabled', true);
	$("input, select").prop('disabled', true);
	$('.input-required').removeClass('input-required');
	$('.selectpicker').selectpicker('refresh');
	$('.bootstrap-select').css('background-color', '#eee');

	$('textarea').attr('readonly', true);
	$('textarea').css("cursor", "not-allowed");
}

function backPreviousPage() {
	var isHttps = false;
	var historyURL = getCookie("pageURL");
	var textSplit = "http";
	isHttps = historyURL.includes("http");
	if (isHttps) {
		textSplit = "http";
	}
	var urlList = historyURL.split(textSplit);
	var urlListLen = urlList.length;
	var newHistoryURL = "";
	for (var i = 2; i < urlListLen; i++) {
		if (!urlList[i].includes("undefine") && urlList[i] !== "") {
			newHistoryURL = newHistoryURL + textSplit + urlList[i];
		}
		if (i == 5) {
			break;
		}
	}
	setCookie("pageURL", newHistoryURL, 1);
	if (urlListLen > 2) {
		window.location = textSplit + urlList[2];
	} else {
		history.go(-1);
	}
}

function setpage(pageURL) {
	if (pageURL !== "undefined" && !(pageURL.includes("fled06") || pageURL.includes("fled05") || pageURL.includes("fled03") || pageURL.includes("fled02") || pageURL.includes("fled11") || pageURL.includes("fled12") || pageURL.includes("fled10") || pageURL.includes("history") || pageURL.includes("selectDevice") || pageURL.includes("fled13") || pageURL.includes("fled14") || pageURL.includes("fled21"))) {
		var historyURL = getCookie("pageURL");
		if (historyURL === "") {
			setCookie("pageURL", pageURL, 0.5);
		} else {
			var urlList = historyURL.split("http");
			var urlListLen = urlList.length;
			var newHistoryURL = pageURL;
			for (var i = 1; i < urlListLen; i++) {
				var urlTemp = "http" + urlList[i];
				if (!urlList[i].includes("undefine") && urlList[i] !== "" && urlTemp != pageURL) {
					newHistoryURL = newHistoryURL + urlTemp;
				}
				if (i == 5) {
					break;
				}
				setCookie("pageURL", newHistoryURL, 0.5);
			}
		}
	}
}

function setCookie(cname, cvalue, exdays) {
	var d = new Date();
	d.setTime(d.getTime() + (exdays * 24 * 60 * 60 * 1000));
	var expires = "expires=" + d.toUTCString();
	document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
}

function getCookie(cname) {
	var name = cname + "=";
	var ca = document.cookie.split(';');
	for (var i = 0; i < ca.length; i++) {
		var c = ca[i];
		while (c.charAt(0) == ' ') {
			c = c.substring(1);
		}
		if (c.indexOf(name) == 0) {
			return c.substring(name.length, c.length);
		}
	}
	return "";
}

function isValidDate(date) {
	var pattern = /^\d{4}\/\d{2}\/\d{2}$/;
	return pattern.test(date);
}

function startTimeChangeEvent(startDom, idTargetSetValue) {
	var startValue = startDom.value;
	var targetValue = $(idTargetSetValue).val();

	// TODO validate value
	if (!targetValue && isValidDate(startValue)) {
		$(idTargetSetValue).val(startValue);
	}
}